<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <meta http-equiv="Referrer-Policy" content="no-referrer" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; style-src 'self'; img-src 'self' data: blob:; media-src 'self'; connect-src 'self' https://tctrtklwqmynkfssipgc.supabase.co wss://tctrtklwqmynkfssipgc.supabase.co; font-src 'self'; object-src 'none'; base-uri 'self'; form-action 'self'; frame-ancestors 'none'; upgrade-insecure-requests; block-all-mixed-content"
    />
    <title>Lulu-Snake</title>
    <link rel="stylesheet" href="styles.css?v=22" />
  </head>
  <body>
    <main class="shell">
      <header class="topbar">
        <div class="title">
          <h1 class="game-title">
            <span>Lulu</span>
            <span>Snake</span>
          </h1>
          <p>Arrow keys/WASD or swipe anywhere. Space pauses, R restarts.</p>
        </div>
        <div id="rage-indicator" class="rage-indicator" hidden>
          <strong>LULU-RAGE x2</strong>
          <span id="rage-timer">15.0s</span>
        </div>
        <button id="audio-toggle" class="audio-toggle" type="button" aria-label="Audio On" title="Audio On">ðŸ”Š</button>
        <div class="scoreboard">
          <span>Score</span>
          <strong id="score">0</strong>
        </div>
        <div id="opponent-scoreboard" class="scoreboard opponent-scoreboard" hidden>
          <span>Opponent</span>
          <strong id="opponent-score">0</strong>
        </div>
      </header>

      <section class="stage">
        <canvas id="game" width="920" height="920" aria-label="Snake game board"></canvas>
        <div id="chaser-alert" class="chaser-alert" hidden>
          <strong>OH NO WINDHUND LADY LOST CONTROL</strong>
          <span id="chaser-name">ASKABAN</span>
        </div>
        <div id="rage-popup" class="rage-popup" hidden>
          <div class="rage-card">
            <h2>Lulu-Rage</h2>
            <img src="./assets/snake-head.png" alt="Lulu face" />
          </div>
        </div>
        <div id="overlay" class="overlay" role="status" aria-live="polite">
          <div class="menu-card">
            <h2 id="menu-title">Lulu-Snake</h2>
            <p id="menu-text">Press Start to begin.</p>
            <div class="menu-scores">
              <h3 id="top5-title">Top 5</h3>
              <ol id="menu-highscore-list" class="menu-highscore-list"></ol>
            </div>
            <div class="mode-switch" role="group" aria-label="Game mode">
              <button id="mode-single" type="button" class="mode-btn active">Single Player</button>
              <button id="mode-duel" type="button" class="mode-btn">1v1 Online</button>
            </div>
            <div id="duel-panel" class="duel-panel" hidden>
              <p class="duel-help">Create a room or enter a code to join.</p>
              <div class="duel-row">
                <input id="duel-room-input" type="text" maxlength="8" placeholder="ROOM42" autocomplete="off" spellcheck="false" />
                <button id="duel-create" type="button">Create</button>
                <button id="duel-join" type="button">Join</button>
              </div>
              <p id="duel-status" class="duel-status" aria-live="polite">Not connected.</p>
            </div>
            <div id="name-entry" class="name-entry" hidden>
              <label for="name-entry-input" hidden>Top 5 reached. Enter your name:</label>
              <input id="name-entry-input" type="text" maxlength="24" placeholder="Player" />
              <button id="save-score">Save Score</button>
            </div>
            <button id="start-game">Start Game</button>
          </div>
        </div>
      </section>

      <section class="controls" aria-label="On-screen controls">
        <div class="actions">
          <button id="pause">Pause</button>
          <button id="restart">Restart</button>
        </div>
      </section>

    </main>

    <script type="module" src="app.js?v=70"></script>
  </body>
</html>
